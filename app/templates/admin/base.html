<!-- app/templates/admin/base.html -->
{% extends "base.html" %} {% block title %}{% block admin_title %}Admin -
Eventos Tec{% endblock %}{% endblock %} {% block content %}
<div
  class="min-h-screen bg-gray-50"
  x-data="{ ...adminDashboard(), ...sessionStatusManager() }"
  x-init="initDashboard(); checkStatus()"
>
  <!-- Header Desktop -->
  <header class="bg-white shadow hidden md:block">
    <div class="px-4 py-4 flex justify-between items-center">
      <div class="flex items-center">
        <h1 class="text-xl font-bold text-gray-900">Panel de Administrador</h1>
      </div>
      <div class="flex items-center space-x-4">
        <div class="relative">
          <button
            class="p-1 rounded-full text-gray-600 hover:text-gray-900 focus:outline-none"
          >
            <i class="ti ti-bell text-xl"></i>
          </button>
          <span
            class="absolute top-0 right-0 block h-2 w-2 rounded-full ring-2 ring-white bg-red-400"
          ></span>
        </div>
        <div class="relative" x-data="{ dropdownOpen: false }">
          <button
            @click="dropdownOpen = !dropdownOpen"
            class="flex items-center text-sm rounded-full focus:outline-none"
          >
            <div
              class="relative h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center"
            >
              <span class="text-indigo-800 font-medium">A</span>
              <!-- Indicador de estado de sesión -->
              <span
                :class="getStatusClasses()"
                :title="getTooltip()"
                class="absolute -top-0.5 -right-0.5 h-3 w-3 rounded-full ring-2 ring-white"
              ></span>
            </div>
          </button>

          <div
            x-show="dropdownOpen"
            @click.away="dropdownOpen = false"
            x-transition:enter="transition ease-out duration-100"
            x-transition:enter-start="transform opacity-0 scale-95"
            x-transition:enter-end="transform opacity-100 scale-100"
            x-transition:leave="transition ease-in duration-75"
            x-transition:leave-start="transform opacity-100 scale-100"
            x-transition:leave-end="transform opacity-0 scale-95"
            class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none"
          >
            <a
              href="#"
              class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
            >
              <i class="ti ti-user mr-2"></i>Perfil
            </a>
            <a
              href="#"
              class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
            >
              <i class="ti ti-settings mr-2"></i>Ajustes
            </a>
            <div class="border-t border-gray-100"></div>
            <a
              href="#"
              @click.prevent="logout()"
              class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100"
            >
              <i class="ti ti-logout mr-2"></i>Cerrar Sesión
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Header -->
  <header class="bg-white shadow sticky top-0 z-10 md:hidden">
    <div class="px-4 py-4 flex justify-between items-center">
      <div class="flex items-center">
        <button @click="toggleSidebar()" class="mr-3 text-gray-600">
          <i class="ti ti-menu-2 text-xl"></i>
        </button>
        <h1 class="text-lg font-bold text-gray-900">Admin Panel</h1>
      </div>
      <div class="flex items-center space-x-3">
        <button @click="logout()" class="text-gray-600 hover:text-gray-900">
          <i class="ti ti-logout"></i>
        </button>
      </div>
    </div>
  </header>

  <div class="flex">
    <!-- Sidebar Mobile (Offcanvas) -->
    <div
      x-show="sidebarOpen"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 transform translate-x-[-100%]"
      x-transition:enter-end="opacity-100 transform translate-x-0"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100 transform translate-x-0"
      x-transition:leave-end="opacity-0 transform translate-x-[-100%]"
      class="fixed inset-0 z-20 md:hidden"
    >
      <div
        class="absolute inset-0 bg-black opacity-50"
        @click="sidebarOpen = false"
      ></div>
      <div class="relative bg-white w-64 h-full overflow-y-auto">
        <div class="p-4 border-b">
          <h2 class="text-lg font-semibold">Menú</h2>
        </div>
        <nav class="p-2">
          <template x-for="item in menuItems" :key="item.id">
            <button
              @click="setActiveTab(item.id); sidebarOpen = false"
              :class="{'bg-indigo-50 text-indigo-600': activeTab === item.id}"
              class="w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-50 transition-colors mb-1"
            >
              <i :class="item.icon" class="mr-3"></i>
              <span x-text="item.name"></span>
            </button>
          </template>
        </nav>
      </div>
    </div>

    <!-- Sidebar Desktop -->
    <aside
      class="hidden md:block w-64 bg-white border-r border-gray-200 min-h-[calc(100vh-65px)]"
    >
      <div class="p-4 border-b">
        <h2 class="text-lg font-semibold">Menú</h2>
      </div>
      <nav class="p-2">
        <template x-for="item in menuItems" :key="item.id">
          <button
            @click="setActiveTab(item.id)"
            :class="{'bg-indigo-50 text-indigo-600': activeTab === item.id}"
            class="w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-50 transition-colors mb-1"
          >
            <i :class="item.icon" class="mr-3"></i>
            <span x-text="item.name"></span>
          </button>
        </template>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-4 md:p-6 overflow-y-auto">
      {% block admin_content %}{% endblock %}
    </main>
  </div>
</div>

<!-- Modal Container (global para todos los modals) -->
<div id="modal-container"></div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/admin/events.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/activities.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/registrations.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/attendances.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/dashboard.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/reports.js') }}"></script>
{% endblock %}
