<!-- templates/admin/partials/students.html -->
<div x-data="studentsAdmin()" x-init="init()">
  <!-- Header con búsqueda y filtros -->
  <div class="bg-white rounded-lg shadow p-4 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
      <!-- Búsqueda -->
      <div class="lg:col-span-2">
        <label
          for="search"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Buscar
        </label>
        <input
          type="text"
          id="search"
          x-model="filters.search"
          @keyup.enter="applyFilters()"
          placeholder="Número de control o nombre..."
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
        />
      </div>

      <!-- Filtro por Evento -->
      <div>
        <label
          for="event-filter"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Evento
        </label>
        <select
          id="event-filter"
          x-model="filters.event_id"
          @change="updateActivitiesFilter()"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
          <option value="">Todos</option>
          <template x-for="event in events" :key="event.id">
            <option :value="event.id" x-text="event.name"></option>
          </template>
        </select>
      </div>

      <!-- Filtro por Actividad -->
      <div>
        <label
          for="activity-filter"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Actividad
        </label>
        <select
          id="activity-filter"
          x-model="filters.activity_id"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
          <option value="">Todas</option>
          <template x-for="activity in activities" :key="activity.id">
            <option :value="activity.id" x-text="activity.name"></option>
          </template>
        </select>
      </div>

      <!-- Filtro por Carrera -->
      <div>
        <label
          for="career-filter"
          class="block text-sm font-medium text-gray-700 mb-1"
        >
          Carrera
        </label>
        <input
          type="text"
          id="career-filter"
          x-model="filters.career"
          @keyup.enter="applyFilters()"
          placeholder="Nombre de carrera..."
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
        />
      </div>
    </div>

    <!-- Botones de acción -->
    <div class="flex justify-end gap-2 mt-4">
      <button
        @click="openExportModal()"
        class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700"
        title="Exportar estudiantes con 10+ horas"
      >
        <i class="ti ti-file-export mr-1"></i>
        Exportar Créditos
      </button>
      <button
        @click="clearFilters()"
        class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"
      >
        Limpiar
      </button>
      <button
        @click="applyFilters()"
        class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700"
      >
        Aplicar Filtros
      </button>
    </div>
  </div>

  <!-- Loading state -->
  <div x-show="loading" class="text-center py-12">
    <div
      class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"
    ></div>
    <p class="mt-4 text-gray-600">Cargando estudiantes...</p>
  </div>

  <!-- Error state -->
  <div
    x-show="!loading && errorMessage"
    class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6"
  >
    <p class="text-red-800" x-text="errorMessage"></p>
  </div>

  <!-- Tabla de estudiantes -->
  <div
    x-show="!loading && !errorMessage"
    class="bg-white rounded-lg shadow overflow-hidden"
  >
    <!-- Desktop view -->
    <div class="hidden md:block overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
            >
              Estudiante
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
            >
              Carrera
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
            >
              Email
            </th>
            <th
              class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"
            >
              Acciones
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <template x-for="student in students" :key="student.id">
            <tr class="hover:bg-gray-50">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div
                    class="flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"
                  >
                    <i class="ti ti-user text-indigo-600"></i>
                  </div>
                  <div class="ml-4">
                    <div
                      class="text-sm font-medium text-gray-900"
                      x-text="student.full_name"
                    ></div>
                    <div
                      class="text-sm text-gray-500"
                      x-text="student.control_number"
                    ></div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div
                  class="text-sm text-gray-900"
                  x-text="student.career || 'Sin carrera'"
                ></div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div
                  class="text-sm text-gray-500"
                  x-text="student.email || 'Sin email'"
                ></div>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  @click="viewStudentDetail(student)"
                  class="text-indigo-600 hover:text-indigo-900"
                >
                  <i class="ti ti-eye mr-1"></i>
                  Ver Detalle
                </button>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>

    <!-- Mobile view -->
    <div class="md:hidden">
      <template x-for="student in students" :key="student.id">
        <div class="p-4 border-b border-gray-200">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center">
              <div
                class="flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"
              >
                <i class="ti ti-user text-indigo-600"></i>
              </div>
              <div class="ml-3">
                <div
                  class="text-sm font-medium text-gray-900"
                  x-text="student.full_name"
                ></div>
                <div
                  class="text-xs text-gray-500"
                  x-text="student.control_number"
                ></div>
              </div>
            </div>
          </div>
          <div class="ml-13 space-y-1">
            <div class="text-sm text-gray-600">
              <span class="font-medium">Carrera:</span>
              <span x-text="student.career || 'Sin carrera'"></span>
            </div>
            <div class="text-sm text-gray-600">
              <span class="font-medium">Email:</span>
              <span x-text="student.email || 'Sin email'"></span>
            </div>
          </div>
          <div class="mt-3">
            <button
              @click="viewStudentDetail(student)"
              class="w-full px-3 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-md hover:bg-indigo-100"
            >
              <i class="ti ti-eye mr-1"></i>
              Ver Detalle
            </button>
          </div>
        </div>
      </template>
    </div>

    <!-- Empty state -->
    <div x-show="students.length === 0" class="text-center py-12">
      <i class="ti ti-users-off text-4xl text-gray-400 mb-4"></i>
      <p class="text-gray-600">No se encontraron estudiantes</p>
    </div>
  </div>

  <!-- Paginación -->
  <div
    x-show="!loading && students.length > 0"
    class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-6 rounded-lg shadow"
  >
    <div class="flex-1 flex justify-between sm:hidden">
      <button
        @click="changePage(pagination.current_page - 1)"
        :disabled="pagination.current_page === 1"
        class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"
      >
        Anterior
      </button>
      <button
        @click="changePage(pagination.current_page + 1)"
        :disabled="pagination.current_page === pagination.last_page"
        class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"
      >
        Siguiente
      </button>
    </div>
    <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
      <div>
        <p class="text-sm text-gray-700">
          Mostrando
          <span class="font-medium" x-text="pagination.from"></span>
          a
          <span class="font-medium" x-text="pagination.to"></span>
          de
          <span class="font-medium" x-text="pagination.total"></span>
          resultados
        </p>
      </div>
      <div>
        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
          <button
            @click="changePage(pagination.current_page - 1)"
            :disabled="pagination.current_page === 1"
            class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"
          >
            <i class="ti ti-chevron-left"></i>
          </button>
          <template x-for="page in pagination.pages" :key="page">
            <button
              @click="changePage(page)"
              :class="page === pagination.current_page ? 'bg-indigo-50 border-indigo-500 text-indigo-600' : 'bg-white border-gray-300 text-gray-500 hover:bg-gray-50'"
              class="relative inline-flex items-center px-4 py-2 border text-sm font-medium"
              x-text="page"
            ></button>
          </template>
          <button
            @click="changePage(pagination.current_page + 1)"
            :disabled="pagination.current_page === pagination.last_page"
            class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"
          >
            <i class="ti ti-chevron-right"></i>
          </button>
        </nav>
      </div>
    </div>
  </div>

  <!-- Modal de detalle del estudiante -->
  <div
    x-show="showDetailModal"
    x-transition
    class="fixed inset-0 overflow-y-auto z-50"
    style="display: none"
  >
    <div
      class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"
    >
      <div
        x-show="showDetailModal"
        x-transition
        class="fixed inset-0 transition-opacity"
        @click="closeDetailModal()"
      >
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>

      <div
        x-show="showDetailModal"
        x-transition
        class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"
        @click.stop
      >
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-lg font-medium text-gray-900">
                Historial de Participación
              </h3>
              <div class="mt-2" x-show="currentStudent">
                <p class="text-sm text-gray-600">
                  <span
                    class="font-medium"
                    x-text="currentStudent?.full_name"
                  ></span>
                  <span class="text-gray-400 mx-2">•</span>
                  <span x-text="currentStudent?.control_number"></span>
                </p>
                <p
                  class="text-sm text-gray-500"
                  x-text="currentStudent?.career"
                ></p>
              </div>
            </div>
            <button
              @click="closeDetailModal()"
              class="text-gray-400 hover:text-gray-500"
            >
              <i class="ti ti-x text-xl"></i>
            </button>
          </div>

          <!-- Loading -->
          <div x-show="loadingDetail" class="text-center py-12">
            <div
              class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"
            ></div>
            <p class="mt-4 text-gray-600">Cargando historial...</p>
          </div>

          <!-- Eventos con horas -->
          <div x-show="!loadingDetail" class="mt-6">
            <div
              x-show="studentEventsHours.length === 0"
              class="text-center py-8 text-gray-500"
            >
              <i class="ti ti-calendar-off text-4xl mb-2"></i>
              <p>El estudiante no tiene horas confirmadas en ningún evento</p>
            </div>

            <div x-show="studentEventsHours.length > 0" class="space-y-4">
              <template
                x-for="eventData in studentEventsHours"
                :key="eventData.event_id"
              >
                <div
                  class="border border-gray-200 rounded-lg p-4 hover:border-indigo-300 transition-colors"
                >
                  <div class="flex items-start justify-between">
                    <div class="flex-1">
                      <div class="flex items-center gap-2">
                        <h4
                          class="text-base font-medium text-gray-900"
                          x-text="eventData.event_name"
                        ></h4>
                        <span
                          x-show="eventData.has_complementary_credit"
                          class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
                        >
                          <i class="ti ti-award mr-1"></i>
                          Crédito Complementario
                        </span>
                      </div>
                      <p class="text-sm text-gray-500 mt-1">
                        <span
                          x-text="formatDate(eventData.event_start_date)"
                        ></span>
                        -
                        <span
                          x-text="formatDate(eventData.event_end_date)"
                        ></span>
                      </p>
                      <div class="mt-3 flex items-center gap-4 text-sm">
                        <div class="flex items-center text-gray-700">
                          <i class="ti ti-clock mr-1"></i>
                          <span
                            class="font-medium"
                            x-text="eventData.total_hours.toFixed(1)"
                          ></span>
                          <span class="ml-1">horas confirmadas</span>
                        </div>
                        <div class="flex items-center text-gray-700">
                          <i class="ti ti-book mr-1"></i>
                          <span
                            class="font-medium"
                            x-text="eventData.activities_count"
                          ></span>
                          <span class="ml-1">actividades</span>
                        </div>
                      </div>
                    </div>
                    <button
                      @click="viewEventDetail(eventData)"
                      class="ml-4 text-indigo-600 hover:text-indigo-800 text-sm font-medium"
                    >
                      <i class="ti ti-eye mr-1"></i>
                      Ver Actividades
                    </button>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de detalle de evento específico -->
  <div
    x-show="showEventDetailModal"
    x-transition
    class="fixed inset-0 overflow-y-auto z-50"
    style="display: none"
  >
    <div
      class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"
    >
      <div
        x-show="showEventDetailModal"
        x-transition
        class="fixed inset-0 transition-opacity"
        @click="closeEventDetailModal()"
      >
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>

      <div
        x-show="showEventDetailModal"
        x-transition
        class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full"
        @click.stop
      >
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-lg font-medium text-gray-900">
                Cronología de Actividades
              </h3>
              <div class="mt-2" x-show="currentEventDetail">
                <p
                  class="text-sm text-gray-900 font-medium"
                  x-text="currentEventDetail?.event_name"
                ></p>
                <div class="flex items-center gap-3 mt-1">
                  <span class="text-sm text-gray-600">
                    <i class="ti ti-clock mr-1"></i>
                    <span
                      class="font-medium"
                      x-text="currentEventDetail?.total_confirmed_hours?.toFixed(1)"
                    ></span>
                    horas confirmadas
                  </span>
                  <span
                    x-show="currentEventDetail?.has_complementary_credit"
                    class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
                  >
                    <i class="ti ti-award mr-1"></i>
                    Crédito Complementario
                  </span>
                </div>
              </div>
            </div>
            <button
              @click="closeEventDetailModal()"
              class="text-gray-400 hover:text-gray-500"
            >
              <i class="ti ti-x text-xl"></i>
            </button>
          </div>

          <!-- Loading -->
          <div x-show="loadingEventDetail" class="text-center py-12">
            <div
              class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"
            ></div>
            <p class="mt-4 text-gray-600">Cargando actividades...</p>
          </div>

          <!-- Cronología de actividades -->
          <div x-show="!loadingEventDetail" class="mt-6">
            <div class="flow-root">
              <ul class="-mb-8">
                <template
                  x-for="(activity, index) in eventActivities"
                  :key="activity.registration_id"
                >
                  <li>
                    <div class="relative pb-8">
                      <span
                        x-show="index !== eventActivities.length - 1"
                        class="absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200"
                      ></span>
                      <div class="relative flex space-x-3">
                        <div>
                          <span
                            :class="getStatusBadgeClass(activity.status)"
                            class="h-8 w-8 rounded-full flex items-center justify-center ring-8 ring-white"
                          >
                            <i
                              :class="{
                                'ti ti-check': activity.status === 'Asistió',
                                'ti ti-clock': activity.status === 'Confirmado',
                                'ti ti-x': activity.status === 'Ausente' || activity.status === 'Cancelado',
                                'ti ti-bookmark': activity.status === 'Registrado'
                              }"
                              class="text-sm"
                            ></i>
                          </span>
                        </div>
                        <div
                          class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4"
                        >
                          <div>
                            <p
                              class="text-sm font-medium text-gray-900"
                              x-text="activity.activity_name"
                            ></p>
                            <p class="text-xs text-gray-500 mt-0.5">
                              <span x-text="activity.activity_type"></span>
                              <span class="mx-1">•</span>
                              <span
                                x-text="activity.duration_hours + ' horas'"
                              ></span>
                            </p>
                            <p class="text-xs text-gray-500 mt-1">
                              <i class="ti ti-calendar mr-1"></i>
                              <span
                                x-text="formatDateTime(activity.start_datetime)"
                              ></span>
                            </p>
                            <p class="text-xs text-gray-500">
                              <i class="ti ti-map-pin mr-1"></i>
                              <span x-text="activity.location"></span>
                            </p>
                          </div>
                          <div class="text-right whitespace-nowrap text-sm">
                            <span
                              :class="getStatusBadgeClass(activity.status)"
                              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                              x-text="activity.status"
                            ></span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </li>
                </template>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de exportación de créditos complementarios -->
  <div
    x-show="showExportModal"
    x-transition
    class="fixed inset-0 overflow-y-auto z-50"
    style="display: none"
  >
    <div
      class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"
    >
      <div
        x-show="showExportModal"
        x-transition
        class="fixed inset-0 transition-opacity"
        @click="closeExportModal()"
      >
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>

      <div
        x-show="showExportModal"
        x-transition
        class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"
        @click.stop
      >
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-lg font-medium text-gray-900 flex items-center">
                <i class="ti ti-file-export text-green-600 mr-2 text-xl"></i>
                Exportar Estudiantes con Crédito Complementario
              </h3>
              <p class="mt-2 text-sm text-gray-600">
                Filtra y exporta estudiantes que han acumulado 10+ horas
                confirmadas en un evento específico.
              </p>
            </div>
            <button
              @click="closeExportModal()"
              class="text-gray-400 hover:text-gray-500"
            >
              <i class="ti ti-x text-xl"></i>
            </button>
          </div>

          <!-- Filtros -->
          <div class="mt-6 border-t border-gray-200 pt-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- Evento (requerido) -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  Evento <span class="text-red-500">*</span>
                </label>
                <select
                  x-model="exportFilters.event_id"
                  @change="exportData = []; exportError = ''"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                >
                  <option value="">Seleccionar evento...</option>
                  <template x-for="event in events" :key="event.id">
                    <option :value="event.id" x-text="event.name"></option>
                  </template>
                </select>
              </div>

              <!-- Carrera (opcional) -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                  Carrera (opcional)
                </label>
                <input
                  type="text"
                  x-model="exportFilters.career"
                  @input="exportData = []; exportError = ''"
                  placeholder="Filtrar por carrera..."
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                />
              </div>
            </div>

            <!-- Botón de búsqueda -->
            <div class="mt-4">
              <button
                @click="loadComplementaryCredits()"
                :disabled="!exportFilters.event_id || loadingExport"
                class="w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <span x-show="!loadingExport">
                  <i class="ti ti-search mr-1"></i>
                  Buscar Estudiantes
                </span>
                <span x-show="loadingExport">
                  <i class="ti ti-loader animate-spin mr-1"></i>
                  Buscando...
                </span>
              </button>
            </div>
          </div>

          <!-- Error -->
          <div
            x-show="exportError"
            class="mt-4 bg-red-50 border border-red-200 rounded-lg p-3"
          >
            <p class="text-sm text-red-800" x-text="exportError"></p>
          </div>

          <!-- Resultados -->
          <div
            x-show="exportData.length > 0"
            class="mt-6 border-t border-gray-200 pt-4"
          >
            <div class="mb-4 flex items-center justify-between">
              <h4 class="text-sm font-medium text-gray-900">
                Estudiantes encontrados:
                <span class="text-indigo-600" x-text="exportData.length"></span>
              </h4>
              <button
                @click="exportToExcel()"
                class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700"
              >
                <i class="ti ti-download mr-1"></i>
                Descargar Excel
              </button>
            </div>

            <!-- Tabla de vista previa -->
            <div
              class="max-h-96 overflow-y-auto border border-gray-200 rounded-lg"
            >
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50 sticky top-0">
                  <tr>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      No.
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      No. Control
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      Nombre
                    </th>
                    <th
                      class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      Carrera
                    </th>
                    <th
                      class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      Horas
                    </th>
                    <th
                      class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      Actividades
                    </th>
                  </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                  <template
                    x-for="(student, index) in exportData"
                    :key="student.id"
                  >
                    <tr class="hover:bg-gray-50">
                      <td
                        class="px-4 py-3 text-sm text-gray-900"
                        x-text="index + 1"
                      ></td>
                      <td
                        class="px-4 py-3 text-sm font-medium text-gray-900"
                        x-text="student.control_number"
                      ></td>
                      <td
                        class="px-4 py-3 text-sm text-gray-900"
                        x-text="student.full_name"
                      ></td>
                      <td
                        class="px-4 py-3 text-sm text-gray-600"
                        x-text="student.career"
                      ></td>
                      <td class="px-4 py-3 text-sm text-center">
                        <span
                          class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
                        >
                          <i class="ti ti-clock mr-1"></i>
                          <span
                            x-text="student.total_hours.toFixed(1) + ' hrs'"
                          ></span>
                        </span>
                      </td>
                      <td
                        class="px-4 py-3 text-sm text-center text-gray-900"
                        x-text="student.activities_count"
                      ></td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Estado vacío -->
          <div
            x-show="!loadingExport && exportData.length === 0 && exportFilters.event_id"
            class="mt-6 text-center py-8 text-gray-500"
          >
            <i class="ti ti-users-off text-4xl mb-2"></i>
            <p>
              No se encontraron estudiantes con 10+ horas para los filtros
              seleccionados
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/admin/students.js') }}"></script>
